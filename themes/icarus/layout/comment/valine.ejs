<% if (!has_config('comment.app_id') || !has_config('comment.app_key')) { %>
<div class="notification is-danger">
    You forgot to set the <code>app_id</code> or <code>app_key</code> for Valine. Please set it in <code>_config.yml</code>.
</div>
<% } else { %>
<span
    class="leancloud-visitors">
    <em class="post-meta-item-text">阅读量 </em>
    <i class="leancloud-visitors-count">0</i>
</span>
<div id="valine-thread"
    style="margin-top: 10px">
</div>
<script src="//cdn1.lncld.net/static/js/3.0.4/av-min.js"></script>
<script src='//unpkg.com/valine/dist/Valine.min.js'></script>
<script>
    (function () {
        var span = document.getElementsByClassName('leancloud-visitors')[0];
        span['id'] = window.location.pathname;
        // 貌似 title 有bug
        // span.dataset.flagTitle = document.title;
    })();

    new Valine({
        el: '#valine-thread' ,
        notify: <%= get_config('comment.notify') %>,
        verify: <%= get_config('comment.verify') %>,
        app_id: '<%= get_config('comment.app_id') %>',
        app_key: '<%= get_config('comment.app_key') %>',
        placeholder: '<%= get_config('comment.placeholder') %>',
        visitor: '<%= get_config('comment.visitor') %>'
    });
</script>
<% } %>